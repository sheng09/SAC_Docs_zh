%
% LaTeX配置文件
%

% 文档相关信息
\newcommand{\SACDOCTITLE}{SAC\textbf{参考手册}} % 文档标题
\newcommand{\SACDOCAUTHOR}{SeisMan}             % 文档作者
\newcommand{\SACDOCVERSION}{3.2-dev}                % 文档版本
\newcommand{\SACDOCDATE}{\today}                % 文档更新日期

% SAC相关信息
\newcommand{\SACVERSION}{101.6a}                % 文档对应的SAC版本
\newcommand{\SACDATE}{2013-11-11}               % SAC的发布日期

% 中文支持及中英文字体设置
\usepackage[
    indentfirst,    % 章节标题后首段缩进
    CheckSingle,    % 避免单个CJK字符位于段落最后一行
]{xeCJK}

% 页面设置
\usepackage[top=3.0cm,bottom=2.0cm,left=3.5cm,right=2.5cm]{geometry}

% 间距设置
\usepackage{indentfirst}
\linespread{1.3}                        % 行间距
\addtolength{\parskip}{3pt}             % 段落间距
\setlength{\parindent}{2em}             % 首行缩进

% 标题设置
\usepackage{titlesec}
% 设置Part格式
\titleformat{\part}{\centering\Huge\bfseries}{第\,\thepart\,部分}{1em}{}
% 设置章格式
\titleformat{\chapter}{\centering\Huge\bfseries}{第\,\thechapter\,章}{1em}{}
% 调整subsection前后间距
\titlespacing*{\subsection}{0ex}{-.2ex}{.2ex}
\titlespacing*{\subsubsection}{0ex}{-.1ex}{.1ex}
%设置SACTitle为subsection格式
\newcommand{\SACTitle}[1]{\subsection*{#1}}
\newcommand{\SACCMD}[1]{\section{\texttt{#1}}}

% 目录设置
\usepackage{titletoc}
\setcounter{tocdepth}{2}
\titlecontents{chapter}[0em]
{\vspace{0.2em}\bfseries\Large}
{\thecontentslabel\quad}
{\hspace*{0em}}
{\hfill \contentspage}
\titlecontents{section}[1em]
{\large}
{\thecontentslabel\quad}
{\hspace*{0em}}
{\ \dotfill \ \contentspage}
[\vspace{-0.3em}]

\titlecontents{subsection}[3em]
{\normalsize}
{\thecontentslabel\quad}
{\hspace*{0em}}
{\ \dotfill \ \contentspage}
[\vspace{-0.3em}]

% 双栏目录
\usepackage{multicol}
\makeatletter
\renewcommand{\tableofcontents}{%
\setlength{\columnsep}{2.5em}
\begin{multicols}{2}[\chapter*{\contentsname}]%
    \@starttoc{toc}%
\end{multicols}}
\makeatother

% 页眉页脚设置
\usepackage{titleps}
\newpagestyle{body}{
    \sethead
    [$\cdot$~\thepage~$\cdot$][][\small\S\,\thesection\quad\sectiontitle]
    {第\,\thechapter\,章\quad\chaptertitle}{}{$\cdot$~\thepage~$\cdot$}
    \setfoot{}{}{}\headrule
}

% 空白页
\makeatletter	% copy from lnotes
\def\cleardoublepage{
    \clearpage
    \if@twoside
        \ifodd
            \c@page
        \else
            \hbox{}
            \vspace*{\fill}
            \begin{center}
		    保护环境，从阅读电子文档开始！
            \end{center}
            \vspace{\fill}
            \thispagestyle{empty}
            \newpage
            \if@twocolumn
                \hbox{}
                \newpage
            \fi
        \fi
    \fi
}
\makeatother

% 脚注
\usepackage[perpage]{footmisc}	% 脚注在每一页单独编号

% 超链接及书签
\usepackage[CJKbookmarks=true,colorlinks,linkcolor=blue, citecolor=blue]{hyperref}
\hypersetup{ % 文档元信息
    pdftitle={\SACDOCTITLE v\SACDOCVERSION},
    pdfauthor={\SACDOCAUTHOR},
}

% 代码宏包
\usepackage{listings}
\usepackage[usenames,dvipsnames,svgnames]{xcolor} % 用于code
\lstloadlanguages{[77]Fortran,[ANSI]C,Perl,Python,bash,csh} % 载入所有需要的语言
% lstings的默认设置, 主要用于lstinline
\lstset{
    basicstyle=\ttfamily,	% 使字体保持当前的系列与形状属性，但转变为打字机族属性
}
% 单行代码
\lstdefinestyle{Shell} {
    language=bash,
    basicstyle=\scriptsize\ttfamily,
    xleftmargin=4em,
    xrightmargin=4em,
    breakatwhitespace=false,
    breaklines=true,
    commentstyle=\color[rgb]{0,0.6,0},
    keywordstyle=\color{blue},
    frame=leftline,
%    frame=single,
    framerule=1pt,
    numbers=none,
    rulecolor=\color{blue},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stepnumber=1,
    stringstyle=\color[rgb]{0.58,0,0.82},
    tabsize=4
}
% C
\lstdefinestyle{C} {
    language=c,
    basicstyle=\scriptsize\ttfamily,
    xleftmargin=4em,
    xrightmargin=4em,
    breakatwhitespace=false,
    breaklines=true,
    commentstyle=\color[rgb]{0,0.6,0},
    keywordstyle=\color{blue},
    frame=leftline,
    numbers=left,
    numbersep=5pt,
    numberstyle=\small\color[rgb]{0.5,0.5,0.5},
    rulecolor=\color{black},
    rulesepcolor=\color{blue},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stepnumber=1,
    stringstyle=\color[rgb]{0.58,0,0.82},
    tabsize=4
}
% style for perl
\lstdefinestyle{Perl} {
    language=perl,
    basicstyle=\scriptsize\ttfamily,
    xleftmargin=4em,
    xrightmargin=4em,
    breakatwhitespace=false,
    breaklines=true,
    commentstyle=\color[rgb]{0,0.6,0},
    keywordstyle=\color{blue},
    frame=leftline,
    numbers=left,
    numbersep=5pt,
    numberstyle=\small\color[rgb]{0.5,0.5,0.5},
    rulecolor=\color{black},
    rulesepcolor=\color{blue},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stepnumber=1,
    stringstyle=\color[rgb]{0.58,0,0.82},
    tabsize=4
}
% style for python
\lstdefinestyle{Python} {
    language=python,
    basicstyle=\scriptsize\ttfamily,
    xleftmargin=4em,
    xrightmargin=4em,
    breakatwhitespace=false,
    breaklines=true,
    commentstyle=\color[rgb]{0,0.6,0},
    keywordstyle=\color{blue},
    frame=leftline,
    numbers=left,
    numbersep=5pt,
    numberstyle=\small\color[rgb]{0.5,0.5,0.5},
    rulecolor=\color{black},
    rulesepcolor=\color{blue},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stepnumber=1,
    stringstyle=\color[rgb]{0.58,0,0.82},
    tabsize=4
}
% style for bash
\lstdefinestyle{Bash} {
    language=bash,
    basicstyle=\scriptsize\ttfamily,
    xleftmargin=4em,
    xrightmargin=4em,
    breakatwhitespace=false,
    breaklines=true,
    commentstyle=\color[rgb]{0,0.6,0},
    keywordstyle=\color{blue},
    frame=leftline,
    numbers=left,
    numbersep=5pt,
    numberstyle=\small\color[rgb]{0.5,0.5,0.5},
    rulecolor=\color{black},
    rulesepcolor=\color{blue},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stepnumber=1,
    stringstyle=\color[rgb]{0.58,0,0.82},
    tabsize=4
}
\lstdefinelanguage{SAC} {
%    keywords={SAC},
    otherkeywords={SAC>},   % SAC提示符
    sensitive=true,
    comment=[l][{\color[rgb]{0,0.4,0}}]{//},
    morecomment=[s]{/*}{*/}
}
\lstnewenvironment{SACCode}{
    \lstset{
        language={SAC},                     % 语言
        basicstyle=\scriptsize\ttfamily,    % 字体
        xleftmargin=2pc,                    % 整体布局
        xrightmargin=2pc,
        %lineskip=0pt,                      % 行间距
        backgroundcolor=\color{Lavender},   % 背景色
        frame=single,                       % 边框
        rulecolor=\color{Silver},           % 边框颜色
        keywordstyle=\color{blue},          % 关键字颜色
    }
}{}
\lstnewenvironment{SACSTX}{
    \lstset{
        basicstyle=\scriptsize\ttfamily,
        delim=[is][\textcolor{gray}]{!}{!},
        frame=single,
        xleftmargin=2pc,
        xrightmargin=2pc,
        backgroundcolor=\color{Lavender},
        rulecolor=\color{Silver}
    }
}{}
\lstnewenvironment{SACDFT}{
    \lstset{
        basicstyle=\scriptsize\ttfamily,
        delim=[is][\textcolor{blue}]{!}{!},
        frame=single,
        xleftmargin=2pc,
        xrightmargin=2pc,
        backgroundcolor=\color{Lavender},
        rulecolor=\color{Silver}
    }
}{}

% 列表
\usepackage{enumitem}	% 列表宏包
% itemsep 设置列表间距
% topsep 设置列表前间距
\setenumerate[1]{itemsep=-6pt,partopsep=0pt,parsep=\parskip,topsep=0pt}
\setitemize[1]{itemsep=-6pt,partopsep=0pt,parsep=\parskip,topsep=0pt}
\setdescription{itemsep=-6pt,partopsep=0pt,parsep=\parskip,topsep=0pt,itemindent=0pt}

% 定义\today的格式
\usepackage[yyyymmdd]{datetime}
\renewcommand{\dateseparator}{-}

% 抄录
\usepackage{verbatim}

% 表格
\usepackage{booktabs}               % 三线表

% 图片
\usepackage{graphicx}
\graphicspath{{figures/}}
\usepackage{tikz}
\usepackage{tikz-3dplot}

% 图表浮动体
\usepackage{float}

% 图表标题
\usepackage{caption}
\setlength{\belowcaptionskip}{2pt}  % skip above figure caption
                                     %      beloe table caption
\captionsetup[figure]{      % 图标题
    format=plain,           % plain, hang
    labelformat=default,    % default, empty, simple, brace, parens
    labelsep=colon,         % none, colon, period, space, quad, newline, endash
    justification=centering,
    labelfont={small,bf,},
    textfont=small,
    skip=-10pt,                     % skip below figure caption
    position=top,
}
\captionsetup[table]{      % 表标题
    format=plain,           % plain, hang
    labelformat=default,    % default, empty, simple, brace, parens
    labelsep=colon,         % none, colon, period, space, quad, newline, endash
    justification=centering,
    labelfont={small,bf,},
    textfont=small,
    skip=0pt,
    position=bottom,
}

% 汉化
\renewcommand{\contentsname}{目 \quad 录}
\renewcommand{\listfigurename}{图目录}
\renewcommand{\listtablename}{表目录}
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}
\renewcommand{\bibname}{参考文献}
\renewcommand{\indexname}{索引}
\renewcommand{\figureautorefname}{图}
\renewcommand{\tableautorefname}{表}
\renewcommand{\appendixautorefname}{附录}

% 自定义quote环境
% http://tex.stackexchange.com/questions/16964/block-quote-with-big-quotation-marks
\usepackage{framed}
\newcommand*\openquote{\makebox(25,-22){\scalebox{5}{``}}}
\newcommand*\closequote{\makebox(25,-22){\scalebox{5}{''}}}
\colorlet{shadecolor}{Azure}
\makeatletter
\newif\if@right
\def\shadequote{\@righttrue\shadequote@i}
\def\shadequote@i{\begin{snugshade}\begin{quote}\openquote}
    \def\endshadequote{%
\if@right\hfill\fi\closequote\end{quote}\end{snugshade}}
\@namedef{shadequote*}{\@rightfalse\shadequote@i}
\@namedef{endshadequote*}{\endshadequote}
\makeatother

% 自定义Tips环境
% http://tex.stackexchange.com/questions/158941/xelatex-compilation-error-using-bclogo-mps-image-problem
\usepackage[tikz]{bclogo}
\usepackage{xcolor}
\DeclareGraphicsRule{.mps}{eps}{*}{}
\renewcommand\bcStyleTitre[1]{\quad\bfseries\Large{#1}}
\newenvironment{Tips}{
\begin{bclogo}[couleur = blue!20, arrondi=0.15, logo=\bcloupe, ombre=true,
    couleurOmbre=black!30,blur,noborder=true]{Tips}
}
{\end{bclogo}}
